{{>Common/header}}

<!-- Include Quill.js styles and scripts -->
<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<link href="/assets/css/cssCustom.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>



{{>Common/top_container}}

<div class="container">
  <div class="row">
    <div class="col-lg-12">
      <div class="page-content">
        <h2>Crear una nueva sección</h2>
        <div class="container" style="color: white;">
          <div class="row">



            <div class="col-lg-12">
              <div class="page-content header-text">
                <form action="/section/new" method="post" enctype="multipart/form-data">
                 
                  <div class="form-group">
                    <label for="title">Título:</label>
                    <input type="text" class="form-control" id="title" name="title" required>
                  </div> <br>



                  <div class="form-group editor-container" >
                    <label for="description">Descripción:</label>

                    <div id="editor" class="quill-editor custom-editor" style="height: 200px;"></div> <!-- Contenedor para Quill-->
                    <!--<textarea class="form-control" id="description" name="description" rows="10" required></textarea> -->
                    <input type="hidden" id="description" name="description" required> <!-- Contenido que se mandará sanitizado-->
                    
                  </div>
                  
                  
                  
                  <br>
                  <div class="form-group">
                    <label for="sectionImage">Imagen para la carátula:</label>
                    <input type="file" class="form-control file-input-small" id="sectionImage" name="sectionImage"
                      required>
                  </div> <br>
                  <div class="d-flex justify-content-center">
                    <button type="submit" class="btn btn-primary">Publicar</button>
                  </div>
                </form>
              </div>




            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{{>Common/bottom_container}}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Inicializar Quill
    const quill = new Quill('#editor', {
        theme: 'snow',
        placeholder: 'Escribe tu descripción aquí...',
        modules: {
            toolbar: [
                [{ 'header': [1, 2, false] }],
                ['bold', 'italic', 'underline'],
                ['clean']
            ]
        }
    });

    // Manejar el envío del formulario
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        // Sincronizar el contenido de Quill al campo oculto
        const rawDescription = quill.root.innerHTML;
        const cleanedDescription = DOMPurify.sanitize(rawDescription);
        
        // Validar que haya contenido
        if (quill.getText().trim().length === 0) {
            e.preventDefault();
            alert('La descripción no puede estar vacía');
            return;
        }
        
        document.getElementById('description').value = cleanedDescription;
    });
});
</script>


{{>Common/footer}}